<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>GOBIPEDIA | Carrera</title>

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, sans-serif;
      background: linear-gradient(180deg, #e6f4ff, #ffffff);
    }

    /* ================= HEADER ================= */
    header {
      background-color: #0b5ed7;
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative; /* CLAVE: permite logo grande sin crecer panel */
    }

    .header-left {
      display: flex;
      align-items: center;
    }

    /* LOGO GRANDE (NO EMPUJA EL HEADER) */
    .header-logo {
      height: 110px;          /* tamaño grande del logo */
      width: auto;
      position: absolute;    /* lo saca del flujo */
      top: 50%;
      left: 20px;
      transform: translateY(-50%);
    }

    .header-left h1 {
      margin: 0;
      margin-left: 120px;    /* espacio para que no choque con la mascota */
      font-size: 24px;
      cursor: pointer;
    }

    header button {
      background: white;
      color: #0b5ed7;
      border: none;
      padding: 8px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    header .user-info {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
    }

    /* ================= MAIN ================= */
    main {
      padding: 40px;
    }

    .breadcrumb {
      font-size: 14px;
      margin-bottom: 10px;
    }

    .breadcrumb a {
      color: #0b5ed7;
      text-decoration: none;
      font-weight: 600;
    }

    .ramos {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 30px;
      margin-top: 30px;
    }

    .ramo-card {
      background: white;
      padding: 25px;
      border-radius: 16px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.2s;
    }

    .ramo-card:hover {
      transform: translateY(-5px);
    }

    .ramo-card h3 {
      color: #0b5ed7;
      margin-top: 0;
    }
  </style>
</head>

<body>

<!-- ================= HEADER ================= -->
<header>
  <div class="header-left">
    <img src="mascot.png" alt="Mascota Gobipedia" class="header-logo">
    <h1 onclick="location.href='index.html'">GOBIPEDIA</h1>
  </div>

  <div id="userArea">
    <a href="login.html">
      <button>Ingresar a la comunidad</button>
    </a>
  </div>
</header>

<!-- ================= CONTENIDO ================= -->
<main>
  <div class="breadcrumb">
    <a href="index.html">Inicio</a> &gt; <span>Carrera</span>
  </div>

  <h2 id="careerTitle">Carrera</h2>

  <div class="ramos" id="ramosContainer"></div>
</main>

<!-- ================= SCRIPT ================= -->
<script>
  /* ===== SUPABASE ===== */
  const supabase = window.supabase.createClient(
    "https://vcoritivebetnnlksgei.supabase.co",
    "sb_publishable_iaz-FQ8wkgebZsFDoXLZ0Q_LVhoucy9"
  );

  function updateUI(session) {
    const userArea = document.getElementById("userArea");
    if (!userArea) return;

    if (session) {
      userArea.innerHTML = `
        <div class="user-info">
          <span>${session.user.email}</span>
          <button onclick="logout()">Cerrar sesión</button>
        </div>
      `;
    } else {
      userArea.innerHTML = `
        <a href="login.html">
          <button>Ingresar a la comunidad</button>
        </a>
      `;
    }
  }

  async function logout() {
    await supabase.auth.signOut();
    location.reload();
  }

  supabase.auth.getSession().then(({ data }) => {
    updateUI(data.session);
  });

  supabase.auth.onAuthStateChange((_event, session) => {
    updateUI(session);
  });

  /* ===== LÓGICA CARRERA ===== */
  const params = new URLSearchParams(window.location.search);
  const carrera = params.get("carrera");

  const careerTitle = document.getElementById("careerTitle");
  const ramosContainer = document.getElementById("ramosContainer");

  const carreras = {
    cp: {
      nombre: "Ciencia Política",
      ramos: [
        "Poder, Política y Gobierno",
        "Ideas Políticas",
        "Fundamentos del Sistema Político",
        "Fundamentos del Estado y Gobierno",
        "Lectura y Escritura Académica en Ciencia Política"
      ]
    },
    ap: {
      nombre: "Administración Pública",
      ramos: [
        "Introducción a la Gestión Pública",
        "Evolución de la Administración Pública",
        "Gestión Financiera del Estado"
      ]
    }
  };

  const data = carreras[carrera];

  if (!data) {
    careerTitle.textContent = "Carrera no encontrada";
  } else {
    careerTitle.textContent = `Malla – ${data.nombre}`;
    ramosContainer.innerHTML = "";

    data.ramos.forEach(nombre => {
      const card = document.createElement("div");
      card.className = "ramo-card";
      card.innerHTML = `<h3>${nombre}</h3>`;
      card.onclick = () => {
        location.href = `ramo.html?ramo=${encodeURIComponent(nombre)}`;
      };
      ramosContainer.appendChild(card);
    });
  }
</script>

</body>
</html>
