<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>GOBIPEDIA | Carrera</title>

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, sans-serif;
      background: linear-gradient(180deg, #e6f4ff, #ffffff);
    }

    header {
      background-color: #0b5ed7;
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      margin: 0;
      font-size: 24px;
    }

    header button {
      background: white;
      color: #0b5ed7;
      border: none;
      padding: 8px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    header .user-info {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
    }

    main {
      padding: 40px;
    }

    .breadcrumb {
      font-size: 14px;
      margin-bottom: 10px;
    }

    .breadcrumb a {
      color: #0b5ed7;
      text-decoration: none;
      font-weight: 600;
    }

    .ramos {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 30px;
      margin-top: 30px;
    }

    .ramo-card {
      background: white;
      padding: 25px;
      border-radius: 16px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.2s;
    }

    .ramo-card:hover {
      transform: translateY(-5px);
    }

    .ramo-card h3 {
      color: #0b5ed7;
      margin-top: 0;
    }
  </style>
</head>

<body>

<header>
  <h1>üê¨ GOBIPEDIA</h1>
  <div id="userArea">
    <a href="login.html">
      <button>Ingresar a la comunidad</button>
    </a>
  </div>
</header>

<main>
  <!-- Breadcrumb -->
  <div class="breadcrumb">
    <a href="index.html">Inicio</a> &gt; <span>Carrera</span>
  </div>

  <!-- T√≠tulo din√°mico -->
  <h2 id="careerTitle">Carrera</h2>

  <!-- Ramos -->
  <div class="ramos" id="ramosContainer"></div>
</main>

<script>
  /* ================= SUPABASE ================= */
  const supabase = window.supabase.createClient(
    "https://vcoritivebetnnlksgei.supabase.co",
    "sb_publishable_iaz-FQ8wkgebZsFDoXLZ0Q_LVhoucy9"
  );

  function updateUI(session) {
    const userArea = document.getElementById("userArea");
    if (!userArea) return;

    if (session) {
      userArea.innerHTML = `
        <div class="user-info">
          <span>${session.user.email}</span>
          <button onclick="logout()">Cerrar sesi√≥n</button>
        </div>
      `;
    } else {
      userArea.innerHTML = `
        <a href="login.html">
          <button>Ingresar a la comunidad</button>
        </a>
      `;
    }
  }

  async function logout() {
    await supabase.auth.signOut();
    location.reload();
  }

  supabase.auth.getSession().then(({ data }) => {
    updateUI(data.session);
  });

  supabase.auth.onAuthStateChange((_event, session) => {
    updateUI(session);
  });

  /* ================= L√ìGICA CARRERA ================= */
  const params = new URLSearchParams(window.location.search);
  const carrera = params.get("carrera");

  const careerTitle = document.getElementById("careerTitle");
  const ramosContainer = document.getElementById("ramosContainer");

  const mallas = {
    "ciencia-politica": {
      nombre: "Ciencia Pol√≠tica",
      ramos: [
        // Primer a√±o ‚Äì 1¬∞ semestre
        "Poder, Pol√≠tica y Gobierno",
        "Ideas Pol√≠ticas",
        "Fundamentos del Sistema Pol√≠tico",
        "Fundamentos del Estado y Gobierno",
        "Lectura y Escritura Acad√©mica en Ciencia Pol√≠tica",
        "Ingl√©s I",

        // Primer a√±o ‚Äì 2¬∞ semestre
        "Evoluci√≥n de las Instituciones I",
        "Pensamiento Pol√≠tico Cl√°sico",
        "Pol√≠tica Comparada I",
        "Epistemolog√≠a de las Ciencias Sociales",
        "Derecho Administrativo y Ciencia Pol√≠tica",
        "Relaciones Internacionales",
        "Ingl√©s II",

        // Segundo a√±o ‚Äì 3¬∞ semestre
        "Evoluci√≥n de las Instituciones II",
        "Pensamiento Pol√≠tico Moderno",
        "Pol√≠tica Comparada II",
        "Metodolog√≠a de la Investigaci√≥n en Ciencia Pol√≠tica",
        "Matem√°tica I",
        "Gobierno Subnacional",
        "Ingl√©s III",

        // Segundo a√±o ‚Äì 4¬∞ semestre
        "Instituciones Contempor√°neas",
        "Pensamiento Pol√≠tico Contempor√°neo",
        "M√©todo Cualitativo",
        "Desaf√≠os de la Globalizaci√≥n",
        "Matem√°tica II",
        "Ingl√©s IV",

        // Tercer a√±o ‚Äì 5¬∞ semestre
        "Estado y Democracia: Ciudadan√≠a Vertical",
        "Fen√≥menos Microecon√≥micos",
        "Sistema Pol√≠tico Chileno",
        "M√©todo Cuantitativo I",
        "Organizaciones Internacionales",
        "Marco Anal√≠tico de las Pol√≠ticas P√∫blicas",

        // Tercer a√±o ‚Äì 6¬∞ semestre
        "Negociaci√≥n y Toma de Decisiones",
        "Fen√≥menos Macroecon√≥micos",
        "Formulaci√≥n e Implementaci√≥n de Pol√≠ticas P√∫blicas",
        "M√©todo Cuantitativo II",
        "Pol√≠tica Latinoamericana",
        "Pensamiento Pol√≠tico Latinoamericano",
        "Pol√≠tica Exterior Latinoamericana",

        // Cuarto a√±o ‚Äì 7¬∞ semestre
        "Estado y Democracia: Ciudadan√≠a Horizontal",
        "Econom√≠a Pol√≠tica",
        "Pol√≠tica de los Pa√≠ses Industrializados",
        "M√©todo Mixto",
        "Evaluaci√≥n de Pol√≠ticas P√∫blicas",

        // Cuarto a√±o ‚Äì 8¬∞ semestre
        "Comunicaci√≥n Estrat√©gica y Marketing Pol√≠tico",
        "Simulaci√≥n de Asesor√≠a",
        "Comportamiento Humano en la Organizaci√≥n",
        "An√°lisis Emp√≠rico de Pol√≠ticas P√∫blicas",
        "Seminario de Investigaci√≥n"
      ]
    }
  };

  if (!mallas[carrera]) {
    careerTitle.textContent = "Carrera no encontrada";
  } else {
    const data = mallas[carrera];
    careerTitle.textContent = `Malla ‚Äì ${data.nombre}`;

    data.ramos.forEach(nombre => {
      const card = document.createElement("div");
      card.className = "ramo-card";
      card.innerHTML = `<h3>${nombre}</h3>`;
      card.onclick = () => {
        location.href = `ramo.html?ramo=${encodeURIComponent(nombre)}`;
      };
      ramosContainer.appendChild(card);
    });
  }
</script>

</body>
</html>
